{"version":3,"file":"url_resolver.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/url_resolver.ts"],"names":[],"mappings":";AAAA,uBAAmD,eAAe,CAAC,CAAA;AACnE,uBAKO,oBAAoB,CAAC,CAAA;AAG5B,MAAM,gBAAgB,CAAC,aAAa,GAAG,QAAQ,CAAC;AAChD;;;GAGG;AACH;IACE,MAAM,CAAC,IAAI,WAAW,EAAE,CAAC;AAC3B,CAAC;AAFe,6CAAqC,wCAEpD,CAAA;AACD;;GAEG;AACH;IACE,MAAM,CAAC,IAAI,WAAW,CAAC,aAAa,CAAC,CAAC;AACxC,CAAC;AAFe,uCAA+B,kCAE9C,CAAA;AAED;;GAEG;AACyB,oCAA4B,GAAG;IACzD,OAAO,EAAE,uBAAgB;IACzB,QAAQ,EAAE,GAAG;CACd,CAAC;AACF;IACA;;OAEG;IACH,YACQ,cAAc,GAAW,IAAI;QAA7B,mBAAc,GAAd,cAAc,CAAe;IAAG,CAAC;IACzC;;;;;OAKG;IACH,OAAO,CAAC,OAAe,EAAE,GAAW;QAChC,IAAI,gBAAgB,CAAC,WAAW,GAAG,GAAG,CAAC;QACvC,EAAE,CAAC,CAAC,gBAAS,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAC7C,WAAW,GAAG,WAAW,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;QAClD,CAAC;QACD,IAAI,gBAAgB,CAAC,aAAa,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC;QACzD,IAAI,gBAAgB,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC;QAClD,EAAE,CAAC,CAAC,gBAAS,CAAC,MAAM,CAAC,IAAI,gBAAS,CAAC,aAAa,CAAC;YAC7C,aAAa,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC;YACvD,IAAI,gBAAgB,CAAC,IAAI,GAAG,aAAa,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YAChE,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,KAAK,aAAa,CAAC,CAAC,CAAC;gBAC1C,IAAI,gBAAgB,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACtD,WAAW,GAAG,SAAS,aAAa,CAAC,CAAC,CAAC,QAAQ,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;YACpF,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,MAAM,GAAG,oBAAa,CAAC,UAAU,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;gBAC/C,IAAI,GAAG,oBAAa,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;gBAC1C,MAAM,CAAC,GAAG,MAAM,IAAI,IAAI,EAAE,CAAC;YAC7B,CAAC;QACH,CAAC;QACD,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;IAED,OAAO,8BAA8B;QACtC,gBAAgB;QACjB,WAAW,CAAC,SAAS,CAAC,cAAc,CAAC;IACnC,CAAC;AAQH,CAAC;AANM,sBAAU,GAA0B;IAC3C,EAAE,IAAI,EAAE,iBAAU,EAAE;CACnB,CAAC;AACK,0BAAc,GAA2D;IAChF,EAAC,IAAI,EAAE,SAAS,EAAE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,aAAM,EAAE,IAAI,EAAE,CAAC,uBAAgB,EAAG,EAAE,EAAG,EAAC;CAC9E,CAAC;AA5CW,mBAAW,cA6CvB,CAAA;AACD;;;;GAIG;AACH,sBAA6B,GAAW;IACtC,IAAI,gBAAgB,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;IACzC,MAAM,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;AACxD,CAAC;AAHe,oBAAY,eAG3B,CAAA;AACD;;;;;;;;;;GAUG;AACH,gCAAgC,UAAmB,EAAE,YAAqB,EAAE,UAAmB,EAC/D,QAAiB,EAAE,QAAiB,EAAE,aAAsB,EAC5D,YAAqB;IACnD,IAAI,gBAAgB,CAAC,GAAG,GAAG,EAAE,CAAC;IAE9B,EAAE,CAAC,CAAC,gBAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC1B,GAAG,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC;IAC7B,CAAC;IAED,EAAE,CAAC,CAAC,gBAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC1B,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEf,EAAE,CAAC,CAAC,gBAAS,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAC5B,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC,CAAC;QAC/B,CAAC;QAED,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAErB,EAAE,CAAC,CAAC,gBAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACxB,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,CAAC;QAC3B,CAAC;IACH,CAAC;IAED,EAAE,CAAC,CAAC,gBAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QACxB,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACrB,CAAC;IAED,EAAE,CAAC,CAAC,gBAAS,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;QAC7B,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,aAAa,CAAC,CAAC;IAChC,CAAC;IAED,EAAE,CAAC,CAAC,gBAAS,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAC5B,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,YAAY,CAAC,CAAC;IAC/B,CAAC;IAED,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACtB,CAAC;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA6DG;AACH,IAAI,gBAAgB,CAAC,QAAQ,GACzB,oBAAa,CAAC,MAAM,CAAC,GAAG;IACH,KAAK;IACL,aAAa;IACI,qCAAqC;IACrC,iBAAiB;IAClC,KAAK;IACL,OAAO;IACP,iBAAiB;IACjB,iCAAiC;IACI,gCAAgC;IAChC,mCAAmC;IACxE,gBAAgB;IAChB,IAAI;IACJ,WAAW;IACX,iBAAiB;IACjB,YAAY;IACZ,GAAG,CAAC,CAAC;AAE9B,IAAI,eAAe,GAAQ,EAAE,CAAC;AAC9B,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;AAC3B,eAAe,CAAC,QAAQ,GAAG,CAAC,CAAC;AAC7B,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;AAC3B,eAAe,CAAC,IAAI,GAAG,CAAC,CAAC;AACzB,eAAe,CAAC,IAAI,GAAG,CAAC,CAAC;AACzB,eAAe,CAAC,SAAS,GAAG,CAAC,CAAC;AAC9B,eAAe,CAAC,QAAQ,GAAG,CAAC,CAAC;AAC7B,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,QAAQ,CAAC;AACnD,eAAe,CAAC,eAAe,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;AACvD,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,QAAQ,CAAC;AACnD,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;AAC/C,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;AAC/C,eAAe,CAAC,eAAe,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC;AACzD,eAAe,CAAC,eAAe,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;AAEvD;;;;GAIG;AACH,gBAAgB,GAAW;IACzB,MAAM,CAAC,oBAAa,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;AACjD,CAAC;AACD;;;;GAIG;AACH,4BAA4B,IAAY;IACtC,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC;QAAC,MAAM,CAAC,GAAG,CAAC;IAE5B,IAAI,gBAAgB,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,CAAC;IAC9D,IAAI,gBAAgB,CAAC,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,EAAE,CAAC;IAC9E,IAAI,gBAAgB,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEhD,IAAI,gBAAgB,CAAC,GAAG,GAAa,EAAE,CAAC;IACxC,IAAI,gBAAgB,CAAC,EAAE,GAAG,CAAC,CAAC;IAC5B,GAAG,CAAC,CAAC,IAAI,gBAAgB,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,QAAQ,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;QAChE,IAAI,gBAAgB,CAAC,OAAO,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;QAC7C,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAChB,KAAK,EAAE,CAAC;YACR,KAAK,GAAG;gBACN,KAAK,CAAC;YACR,KAAK,IAAI;gBACP,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;oBACnB,GAAG,CAAC,GAAG,EAAE,CAAC;gBACZ,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,EAAE,EAAE,CAAC;gBACP,CAAC;gBACD,KAAK,CAAC;YACR;gBACE,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;IACH,CAAC;IAED,EAAE,CAAC,CAAC,YAAY,IAAI,EAAE,CAAC,CAAC,CAAC;QACvB,OAAO,EAAE,EAAE,GAAG,CAAC,EAAE,CAAC;YAChB,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACpB,CAAC;QAED,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,CAAC,CAAC;YAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACtC,CAAC;IAED,MAAM,CAAC,YAAY,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,aAAa,CAAC;AACtD,CAAC;AACD;;;;GAIG;AACH,kCAAkC,KAAY;IAC5C,IAAI,gBAAgB,CAAC,IAAI,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IACxD,IAAI,GAAG,cAAO,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;IACrD,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;IAEnC,MAAM,CAAC,sBAAsB,CAAC,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,EAC9D,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,EAChE,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,EAAE,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC,CAAC;AACnG,CAAC;AACD;;;;;GAKG;AACH,qBAAqB,IAAY,EAAE,GAAW;IAC5C,IAAI,gBAAgB,CAAC,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IACpD,IAAI,gBAAgB,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;IAE9C,EAAE,CAAC,CAAC,gBAAS,CAAC,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7C,MAAM,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;IACpE,CAAC;IAED,GAAG,CAAC,CAAC,IAAI,gBAAgB,CAAC,CAAC,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,IAAI,eAAe,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC;QACrF,EAAE,CAAC,CAAC,cAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACtB,KAAK,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC;IACH,CAAC;IAED,EAAE,CAAC,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;QAC1C,MAAM,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC;IAED,IAAI,gBAAgB,CAAC,IAAI,GAAG,SAAS,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAC5D,EAAE,CAAC,CAAC,cAAO,CAAC,IAAI,CAAC,CAAC;QAAC,IAAI,GAAG,GAAG,CAAC;IAC9B,IAAI,gBAAgB,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;IACnD,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAClE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;IACnC,MAAM,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;AACzC,CAAC","sourcesContent":["import {Injectable, Inject, PACKAGE_ROOT_URL} from '@angular/core';\nimport {\n  StringWrapper,\n  isPresent,\n  isBlank,\n  RegExpWrapper,\n} from '../src/facade/lang';\n\n\nconst /** @type {?} */ _ASSET_SCHEME = 'asset:';\n/**\n *  Create a {@link UrlResolver} with no package prefix.\n * @return {?}\n */\nexport function createUrlResolverWithoutPackagePrefix(): UrlResolver {\n  return new UrlResolver();\n}\n/**\n * @return {?}\n */\nexport function createOfflineCompileUrlResolver(): UrlResolver {\n  return new UrlResolver(_ASSET_SCHEME);\n}\n\n/**\n * A default provider for {@link PACKAGE_ROOT_URL} that maps to '/'.\n */\nexport var /** @type {?} */ DEFAULT_PACKAGE_URL_PROVIDER = {\n  provide: PACKAGE_ROOT_URL,\n  useValue: \"/\"\n};\nexport class UrlResolver {\n/**\n * @param {?=} _packagePrefix\n */\nconstructor(\nprivate _packagePrefix: string = null) {}\n/**\n *  Resolves the `url` given the `baseUrl`: - when the `url` is null, the `baseUrl` is returned, - if `url` is relative ('path/to/here', './path/to/here'), the resolved url is a combination of `baseUrl` and `url`, - if `url` is absolute (it has a scheme: 'http://', 'https://' or start with '/'), the `url` is returned as is (ignoring the `baseUrl`)\n * @param {?} baseUrl\n * @param {?} url\n * @return {?}\n */\nresolve(baseUrl: string, url: string): string {\n    var /** @type {?} */ resolvedUrl = url;\n    if (isPresent(baseUrl) && baseUrl.length > 0) {\n      resolvedUrl = _resolveUrl(baseUrl, resolvedUrl);\n    }\n    var /** @type {?} */ resolvedParts = _split(resolvedUrl);\n    var /** @type {?} */ prefix = this._packagePrefix;\n    if (isPresent(prefix) && isPresent(resolvedParts) &&\n        resolvedParts[_ComponentIndex.Scheme] == \"package\") {\n      var /** @type {?} */ path = resolvedParts[_ComponentIndex.Path];\n      if (this._packagePrefix === _ASSET_SCHEME) {\n        var /** @type {?} */ pathSegements = path.split(/\\//);\n        resolvedUrl = `asset:${pathSegements[0]}/lib/${pathSegements.slice(1).join('/')}`;\n      } else {\n        prefix = StringWrapper.stripRight(prefix, '/');\n        path = StringWrapper.stripLeft(path, '/');\n        return `${prefix}/${path}`;\n      }\n    }\n    return resolvedUrl;\n  }\n\n  static _tsickle_typeAnnotationsHelper() {\n /** @type {?} */\nUrlResolver.prototype._packagePrefix;\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: undefined, decorators: [{ type: Inject, args: [PACKAGE_ROOT_URL, ] }, ]},\n];\n}\n/**\n *  Extract the scheme of a URL.\n * @param {?} url\n * @return {?}\n */\nexport function getUrlScheme(url: string): string {\n  var /** @type {?} */ match = _split(url);\n  return (match && match[_ComponentIndex.Scheme]) || \"\";\n}\n/**\n *  Builds a URI string from already-encoded parts. * No encoding is performed.  Any component may be omitted as either null or undefined. *\n * @param {?=} opt_scheme The scheme such as 'http'.\n * @param {?=} opt_userInfo The user name before the '@'.\n * @param {?=} opt_domain The domain such as 'www.google.com', already URI-encoded.\n * @param {?=} opt_port The port number.\n * @param {?=} opt_path The path, already URI-encoded.  If it is not empty, it must begin with a slash.\n * @param {?=} opt_queryData The URI-encoded query data.\n * @param {?=} opt_fragment The URI-encoded fragment identifier.\n * @return {?} The fully combined URI.\n */\nfunction _buildFromEncodedParts(opt_scheme?: string, opt_userInfo?: string, opt_domain?: string,\n                                opt_port?: string, opt_path?: string, opt_queryData?: string,\n                                opt_fragment?: string): string {\n  var /** @type {?} */ out = [];\n\n  if (isPresent(opt_scheme)) {\n    out.push(opt_scheme + ':');\n  }\n\n  if (isPresent(opt_domain)) {\n    out.push('//');\n\n    if (isPresent(opt_userInfo)) {\n      out.push(opt_userInfo + '@');\n    }\n\n    out.push(opt_domain);\n\n    if (isPresent(opt_port)) {\n      out.push(':' + opt_port);\n    }\n  }\n\n  if (isPresent(opt_path)) {\n    out.push(opt_path);\n  }\n\n  if (isPresent(opt_queryData)) {\n    out.push('?' + opt_queryData);\n  }\n\n  if (isPresent(opt_fragment)) {\n    out.push('#' + opt_fragment);\n  }\n\n  return out.join('');\n}\n\n/**\n * A regular expression for breaking a URI into its component parts.\n *\n * {@link http://www.gbiv.com/protocols/uri/rfc/rfc3986.html#RFC2234} says\n * As the \"first-match-wins\" algorithm is identical to the \"greedy\"\n * disambiguation method used by POSIX regular expressions, it is natural and\n * commonplace to use a regular expression for parsing the potential five\n * components of a URI reference.\n *\n * The following line is the regular expression for breaking-down a\n * well-formed URI reference into its components.\n *\n * <pre>\n * ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?\n *  12            3  4          5       6  7        8 9\n * </pre>\n *\n * The numbers in the second line above are only to assist readability; they\n * indicate the reference points for each subexpression (i.e., each paired\n * parenthesis). We refer to the value matched for subexpression <n> as $<n>.\n * For example, matching the above expression to\n * <pre>\n *     http://www.ics.uci.edu/pub/ietf/uri/#Related\n * </pre>\n * results in the following subexpression matches:\n * <pre>\n *    $1 = http:\n *    $2 = http\n *    $3 = //www.ics.uci.edu\n *    $4 = www.ics.uci.edu\n *    $5 = /pub/ietf/uri/\n *    $6 = <undefined>\n *    $7 = <undefined>\n *    $8 = #Related\n *    $9 = Related\n * </pre>\n * where <undefined> indicates that the component is not present, as is the\n * case for the query component in the above example. Therefore, we can\n * determine the value of the five components as\n * <pre>\n *    scheme    = $2\n *    authority = $4\n *    path      = $5\n *    query     = $7\n *    fragment  = $9\n * </pre>\n *\n * The regular expression has been modified slightly to expose the\n * userInfo, domain, and port separately from the authority.\n * The modified version yields\n * <pre>\n *    $1 = http              scheme\n *    $2 = <undefined>       userInfo -\\\n *    $3 = www.ics.uci.edu   domain     | authority\n *    $4 = <undefined>       port     -/\n *    $5 = /pub/ietf/uri/    path\n *    $6 = <undefined>       query without ?\n *    $7 = Related           fragment without #\n * </pre>\n * @type {!RegExp}\n * @internal\n */\nvar /** @type {?} */ _splitRe =\n    RegExpWrapper.create('^' +\n                         '(?:' +\n                         '([^:/?#.]+)' +  // scheme - ignore special characters\n                                          // used by other URL parts such as :,\n                                          // ?, /, #, and .\n                         ':)?' +\n                         '(?://' +\n                         '(?:([^/?#]*)@)?' +                  // userInfo\n                         '([\\\\w\\\\d\\\\-\\\\u0100-\\\\uffff.%]*)' +  // domain - restrict to letters,\n                                                              // digits, dashes, dots, percent\n                                                              // escapes, and unicode characters.\n                         '(?::([0-9]+))?' +                   // port\n                         ')?' +\n                         '([^?#]+)?' +        // path\n                         '(?:\\\\?([^#]*))?' +  // query\n                         '(?:#(.*))?' +       // fragment\n                         '$');\ntype _ComponentIndex = number;\nlet _ComponentIndex: any = {};\n_ComponentIndex.Scheme = 1;\n_ComponentIndex.UserInfo = 2;\n_ComponentIndex.Domain = 3;\n_ComponentIndex.Port = 4;\n_ComponentIndex.Path = 5;\n_ComponentIndex.QueryData = 6;\n_ComponentIndex.Fragment = 7;\n_ComponentIndex[_ComponentIndex.Scheme] = \"Scheme\";\n_ComponentIndex[_ComponentIndex.UserInfo] = \"UserInfo\";\n_ComponentIndex[_ComponentIndex.Domain] = \"Domain\";\n_ComponentIndex[_ComponentIndex.Port] = \"Port\";\n_ComponentIndex[_ComponentIndex.Path] = \"Path\";\n_ComponentIndex[_ComponentIndex.QueryData] = \"QueryData\";\n_ComponentIndex[_ComponentIndex.Fragment] = \"Fragment\";\n\n/**\n *  Splits a URI into its component parts. * Each component can be accessed via the component indices; for example: <pre> goog.uri.utils.split(someStr)[goog.uri.utils.CompontentIndex.QUERY_DATA]; </pre> *\n * @param {?} uri The URI string to examine.\n * @return {?} Each component still URI-encoded. Each component that is present will contain the encoded value, whereas components that are not present will be undefined or empty, depending on the browser's regular expression implementation.  Never null, since arbitrary strings may still look like path names.\n */\nfunction _split(uri: string): Array<string | any> {\n  return RegExpWrapper.firstMatch(_splitRe, uri);\n}\n/**\n *  Removes dot segments in given path component, as described in RFC 3986, section 5.2.4. *\n * @param {?} path A non-empty path component.\n * @return {?} Path component with removed dot segments.\n */\nfunction _removeDotSegments(path: string): string {\n  if (path == '/') return '/';\n\n  var /** @type {?} */ leadingSlash = path[0] == '/' ? '/' : '';\n  var /** @type {?} */ trailingSlash = path[path.length - 1] === '/' ? '/' : '';\n  var /** @type {?} */ segments = path.split('/');\n\n  var /** @type {?} */ out: string[] = [];\n  var /** @type {?} */ up = 0;\n  for (var /** @type {?} */ pos = 0; pos < segments.length; pos++) {\n    var /** @type {?} */ segment = segments[pos];\n    switch (segment) {\n      case '':\n      case '.':\n        break;\n      case '..':\n        if (out.length > 0) {\n          out.pop();\n        } else {\n          up++;\n        }\n        break;\n      default:\n        out.push(segment);\n    }\n  }\n\n  if (leadingSlash == '') {\n    while (up-- > 0) {\n      out.unshift('..');\n    }\n\n    if (out.length === 0) out.push('.');\n  }\n\n  return leadingSlash + out.join('/') + trailingSlash;\n}\n/**\n *  Takes an array of the parts from split and canonicalizes the path part and then joins all the parts.\n * @param {?} parts\n * @return {?}\n */\nfunction _joinAndCanonicalizePath(parts: any[]): string {\n  var /** @type {?} */ path = parts[_ComponentIndex.Path];\n  path = isBlank(path) ? '' : _removeDotSegments(path);\n  parts[_ComponentIndex.Path] = path;\n\n  return _buildFromEncodedParts(parts[_ComponentIndex.Scheme], parts[_ComponentIndex.UserInfo],\n                                parts[_ComponentIndex.Domain], parts[_ComponentIndex.Port], path,\n                                parts[_ComponentIndex.QueryData], parts[_ComponentIndex.Fragment]);\n}\n/**\n *  Resolves a URL.\n * @param {?} base The URL acting as the base URL.\n * @param {?} url\n * @return {?}\n */\nfunction _resolveUrl(base: string, url: string): string {\n  var /** @type {?} */ parts = _split(encodeURI(url));\n  var /** @type {?} */ baseParts = _split(base);\n\n  if (isPresent(parts[_ComponentIndex.Scheme])) {\n    return _joinAndCanonicalizePath(parts);\n  } else {\n    parts[_ComponentIndex.Scheme] = baseParts[_ComponentIndex.Scheme];\n  }\n\n  for (var /** @type {?} */ i = _ComponentIndex.Scheme; i <= _ComponentIndex.Port; i++) {\n    if (isBlank(parts[i])) {\n      parts[i] = baseParts[i];\n    }\n  }\n\n  if (parts[_ComponentIndex.Path][0] == '/') {\n    return _joinAndCanonicalizePath(parts);\n  }\n\n  var /** @type {?} */ path = baseParts[_ComponentIndex.Path];\n  if (isBlank(path)) path = '/';\n  var /** @type {?} */ index = path.lastIndexOf('/');\n  path = path.substring(0, index + 1) + parts[_ComponentIndex.Path];\n  parts[_ComponentIndex.Path] = path;\n  return _joinAndCanonicalizePath(parts);\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}